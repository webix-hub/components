/**
 * JustGage 
 * Check http://www.justgage.com for official releases
 * Licensed under MIT.
 * @author Bojan Djuricic  (@Toorshia)
 **/
JustGage=function(t){if(!t.id){alert("Missing id parameter for gauge!");return false}if(!document.getElementById(t.id)){alert('No element with id: "'+t.id+'" found!');return false}var i=this;i.config={id:t.id,title:t.title?t.title:"",titleFontColor:t.titleFontColor?t.titleFontColor:"#999999",value:t.value?t.value:0,valueFontColor:t.valueFontColor?t.valueFontColor:"#010101",symbol:t.symbol?t.symbol:"",min:t.min?parseFloat(t.min):0,max:t.max?parseFloat(t.max):100,humanFriendlyDecimal:t.humanFriendlyDecimal?t.humanFriendlyDecimal:0,textRenderer:t.textRenderer?t.textRenderer:null,gaugeWidthScale:t.gaugeWidthScale?t.gaugeWidthScale:1,gaugeColor:t.gaugeColor?t.gaugeColor:"#edebeb",label:t.label?t.label:"",labelFontColor:t.labelFontColor?t.labelFontColor:"#b3b3b3",shadowOpacity:t.shadowOpacity?t.shadowOpacity:.2,shadowSize:t.shadowSize?t.shadowSize:5,shadowVerticalOffset:t.shadowVerticalOffset?t.shadowVerticalOffset:3,levelColors:t.levelColors?t.levelColors:["#a9d70b","#f9c802","#ff0000"],startAnimationTime:t.startAnimationTime?t.startAnimationTime:700,startAnimationType:t.startAnimationType?t.startAnimationType:">",refreshAnimationTime:t.refreshAnimationTime?t.refreshAnimationTime:700,refreshAnimationType:t.refreshAnimationType?t.refreshAnimationType:">",donutStartAngle:t.donutStartAngle?t.donutStartAngle:90,valueMinFontSize:t.valueMinFontSize||16,titleMinFontSize:t.titleMinFontSize||10,labelMinFontSize:t.labelMinFontSize||10,minLabelMinFontSize:t.minLabelMinFontSize||10,maxLabelMinFontSize:t.maxLabelMinFontSize||10,hideValue:t.hideValue?t.hideValue:false,hideMinMax:t.hideMinMax?t.hideMinMax:false,hideInnerShadow:t.hideInnerShadow?t.hideInnerShadow:false,humanFriendly:t.humanFriendly?t.humanFriendly:false,noGradient:t.noGradient?t.noGradient:false,donut:t.donut?t.donut:false,relativeGaugeSize:t.relativeGaugeSize?t.relativeGaugeSize:false,counter:t.counter?t.counter:false,decimals:t.decimals?t.decimals:0,customSectors:t.customSectors?t.customSectors:[]};var e,a,n,o,s,l,r,h,c,f,m,u,g,d,p,x,b,v,y,S,F,M;if(this.config.value>this.config.max)this.config.value=this.config.max;if(this.config.value<this.config.min)this.config.value=this.config.min;this.originalValue=t.value;this.canvas=Raphael(this.config.id,"100%","100%");if(this.config.relativeGaugeSize===true){this.canvas.setViewBox(0,0,200,150,true)}if(this.config.relativeGaugeSize===true){e=200;a=150}else{e=getStyle(document.getElementById(this.config.id),"width").slice(0,-2)*1;a=getStyle(document.getElementById(this.config.id),"height").slice(0,-2)*1}if(this.config.donut===true){if(e>a){o=a;n=o}else if(e<a){n=e;o=n;if(o>a){s=o/a;o=o/s;n=o/s}}else{n=e;o=n}l=(e-n)/2;r=(a-o)/2;h=o/8>10?o/10:10;c=l+n/2;f=r+o/11;m=o/6.4>16?o/5.4:18;u=l+n/2;if(this.config.label!==""){g=r+o/1.85}else{g=r+o/1.7}d=o/16>10?o/16:10;p=l+n/2;x=g+d;b=o/16>10?o/16:10;v=l+n/10+n/6.666666666666667*this.config.gaugeWidthScale/2;y=x;S=o/16>10?o/16:10;F=l+n-n/10-n/6.666666666666667*this.config.gaugeWidthScale/2;M=x}else{if(e>a){o=a;n=o*1.25;if(n>e){s=n/e;n=n/s;o=o/s}}else if(e<a){n=e;o=n/1.25;if(o>a){s=o/a;o=o/s;n=o/s}}else{n=e;o=n*.75}l=(e-n)/2;r=(a-o)/2;h=o/8>this.config.titleMinFontSize?o/10:this.config.titleMinFontSize;c=l+n/2;f=r+o/6.4;m=o/6.5>this.config.valueMinFontSize?o/6.5:this.config.valueMinFontSize;u=l+n/2;g=r+o/1.275;d=o/16>this.config.labelMinFontSize?o/16:this.config.labelMinFontSize;p=l+n/2;x=g+m/2+5;b=o/16>this.config.minLabelMinFontSize?o/16:this.config.minLabelMinFontSize;v=l+n/10+n/6.666666666666667*this.config.gaugeWidthScale/2;y=x;S=o/16>this.config.maxLabelMinFontSize?o/16:this.config.maxLabelMinFontSize;F=l+n-n/10-n/6.666666666666667*this.config.gaugeWidthScale/2;M=x}this.params={canvasW:e,canvasH:a,widgetW:n,widgetH:o,dx:l,dy:r,titleFontSize:h,titleX:c,titleY:f,valueFontSize:m,valueX:u,valueY:g,labelFontSize:d,labelX:p,labelY:x,minFontSize:b,minX:v,minY:y,maxFontSize:S,maxX:F,maxY:M};e,a,n,o,s,l,r,h,c,f,m,u,g,d,p,x,b,v,y,S,F,M=null;this.canvas.customAttributes.pki=function(t,i,e,a,n,o,s,l,r){var h,c,f,m,u,g,d,p,x,b;if(r){h=(1-2*(t-i)/(e-i))*Math.PI;c=a/2-a/7;f=c-a/6.666666666666667*l;m=a/2+o;u=n/1.95+s;g=a/2+o+c*Math.cos(h);d=n-(n-u)+0-c*Math.sin(h);p=a/2+o+f*Math.cos(h);x=n-(n-u)+0-f*Math.sin(h);b+="M"+(m-f)+","+u+" ";b+="L"+(m-c)+","+u+" ";if(t>(e-i)/2){b+="A"+c+","+c+" 0 0 1 "+(m+c)+","+u+" "}b+="A"+c+","+c+" 0 0 1 "+g+","+d+" ";b+="L"+p+","+x+" ";if(t>(e-i)/2){b+="A"+f+","+f+" 0 0 0 "+(m+f)+","+u+" "}b+="A"+f+","+f+" 0 0 0 "+(m-f)+","+u+" ";b+="Z ";return{path:b}}else{h=(1-(t-i)/(e-i))*Math.PI;c=a/2-a/10;f=c-a/6.666666666666667*l;m=a/2+o;u=n/1.25+s;g=a/2+o+c*Math.cos(h);d=n-(n-u)+0-c*Math.sin(h);p=a/2+o+f*Math.cos(h);x=n-(n-u)+0-f*Math.sin(h);b+="M"+(m-f)+","+u+" ";b+="L"+(m-c)+","+u+" ";b+="A"+c+","+c+" 0 0 1 "+g+","+d+" ";b+="L"+p+","+x+" ";b+="A"+f+","+f+" 0 0 0 "+(m-f)+","+u+" ";b+="Z ";return{path:b}}h,c,f,m,u,g,d,p,x,b=null};this.gauge=this.canvas.path().attr({stroke:"none",fill:this.config.gaugeColor,pki:[this.config.max,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut]});this.gauge.id=this.config.id+"-gauge";this.level=this.canvas.path().attr({stroke:"none",fill:getColor(this.config.value,(this.config.value-this.config.min)/(this.config.max-this.config.min),this.config.levelColors,this.config.noGradient,this.config.customSectors),pki:[this.config.min,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut]});if(this.config.donut){this.level.transform("r"+this.config.donutStartAngle+", "+(this.params.widgetW/2+this.params.dx)+", "+(this.params.widgetH/1.95+this.params.dy))}this.level.id=this.config.id+"-level";this.txtTitle=this.canvas.text(this.params.titleX,this.params.titleY,this.config.title);this.txtTitle.attr({"font-size":this.params.titleFontSize,"font-weight":"bold","font-family":"Arial",fill:this.config.titleFontColor,"fill-opacity":"1"});setDy(this.txtTitle,this.params.titleFontSize,this.params.titleY);this.txtTitle.id=this.config.id+"-txttitle";this.txtValue=this.canvas.text(this.params.valueX,this.params.valueY,0);this.txtValue.attr({"font-size":this.params.valueFontSize,"font-weight":"bold","font-family":"Arial",fill:this.config.valueFontColor,"fill-opacity":"0"});setDy(this.txtValue,this.params.valueFontSize,this.params.valueY);this.txtValue.id=this.config.id+"-txtvalue";this.txtLabel=this.canvas.text(this.params.labelX,this.params.labelY,this.config.label);this.txtLabel.attr({"font-size":this.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":"0"});setDy(this.txtLabel,this.params.labelFontSize,this.params.labelY);this.txtLabel.id=this.config.id+"-txtlabel";this.txtMinimum=this.config.min;if(this.config.humanFriendly)this.txtMinimum=humanFriendlyNumber(this.config.min,this.config.humanFriendlyDecimal);this.txtMin=this.canvas.text(this.params.minX,this.params.minY,this.txtMinimum);this.txtMin.attr({"font-size":this.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":this.config.hideMinMax||this.config.donut?"0":"1"});setDy(this.txtMin,this.params.minFontSize,this.params.minY);this.txtMin.id=this.config.id+"-txtmin";this.txtMaximum=this.config.max;if(this.config.humanFriendly)this.txtMaximum=humanFriendlyNumber(this.config.max,this.config.humanFriendlyDecimal);this.txtMax=this.canvas.text(this.params.maxX,this.params.maxY,this.txtMaximum);this.txtMax.attr({"font-size":this.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":this.config.hideMinMax||this.config.donut?"0":"1"});setDy(this.txtMax,this.params.maxFontSize,this.params.maxY);this.txtMax.id=this.config.id+"-txtmax";var A=this.canvas.canvas.childNodes[1];var w="http://www.w3.org/2000/svg";if(ie<9){onCreateElementNsReady(function(){this.generateShadow(w,A)})}else{this.generateShadow(w,A)}A,w=null;function z(){if(i.config.counter){var t=i.level.attr("pki");if(i.config.textRenderer){i.txtValue.attr("text",i.config.textRenderer(Math.floor(t[0])))}else if(i.config.humanFriendly){i.txtValue.attr("text",humanFriendlyNumber(Math.floor(t[0]),i.config.humanFriendlyDecimal)+i.config.symbol)}else{i.txtValue.attr("text",(t[0]*1).toFixed(i.config.decimals)+i.config.symbol)}setDy(i.txtValue,i.params.valueFontSize,i.params.valueY);t=null}}if(!i.config.counter){if(i.config.textRenderer){i.originalValue=i.config.textRenderer(i.originalValue)}else if(i.config.humanFriendly){i.originalValue=humanFriendlyNumber(i.originalValue,i.config.humanFriendlyDecimal)+i.config.symbol}else{i.originalValue=(i.originalValue*1).toFixed(i.config.decimals)}i.txtValue.attr("text",i.originalValue+i.config.symbol);setDy(i.txtValue,i.params.valueFontSize,i.params.valueY)}eve.on("raphael.anim.frame.*",z);this.level.animate({pki:[this.config.value,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut]},this.config.startAnimationTime,this.config.startAnimationType);this.txtValue.animate({"fill-opacity":"1"},this.config.startAnimationTime,this.config.startAnimationType);this.txtLabel.animate({"fill-opacity":"1"},this.config.startAnimationTime,this.config.startAnimationType)};JustGage.prototype.refresh=function(t,i){var e,a,n,i=i||null;if(i!==null){this.config.max=i;this.txtMaximum=this.config.max;if(this.config.humanFriendly)this.txtMaximum=humanFriendlyNumber(this.config.max,this.config.humanFriendlyDecimal);this.txtMax.attr({text:this.config.max});setDy(this.txtMax,this.params.maxFontSize,this.params.maxY)}e=t;a=t;if(t*1>this.config.max*1){t=this.config.max*1}if(t*1<this.config.min*1){t=this.config.min*1}n=getColor(t,(t-this.config.min)/(this.config.max-this.config.min),this.config.levelColors,this.config.noGradient,this.config.customSectors);if(this.config.textRenderer){a=this.config.textRenderer(a)}else if(this.config.humanFriendly){a=humanFriendlyNumber(a,this.config.humanFriendlyDecimal)+this.config.symbol}else{a=(a*1).toFixed(this.config.decimals)+this.config.symbol}if(!this.config.counter){this.canvas.getById(this.config.id+"-txtvalue").attr({text:a});setDy(this.canvas.getById(this.config.id+"-txtvalue"),this.params.valueFontSize,this.params.valueY)}this.canvas.getById(this.config.id+"-level").animate({pki:[t,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut],fill:n},this.config.refreshAnimationTime,this.config.refreshAnimationType);this.config.value=t*1;e,a,n,i=null};JustGage.prototype.generateShadow=function(t,i){var e,a,n,o,s,l,r;e=document.createElementNS(t,"filter");e.setAttribute("id",this.config.id+"-inner-shadow");i.appendChild(e);a=document.createElementNS(t,"feOffset");a.setAttribute("dx",0);a.setAttribute("dy",this.config.shadowVerticalOffset);e.appendChild(a);n=document.createElementNS(t,"feGaussianBlur");n.setAttribute("result","offset-blur");n.setAttribute("stdDeviation",this.config.shadowSize);e.appendChild(n);o=document.createElementNS(t,"feComposite");o.setAttribute("operator","out");o.setAttribute("in","SourceGraphic");o.setAttribute("in2","offset-blur");o.setAttribute("result","inverse");e.appendChild(o);s=document.createElementNS(t,"feFlood");s.setAttribute("flood-color","black");s.setAttribute("flood-opacity",this.config.shadowOpacity);s.setAttribute("result","color");e.appendChild(s);l=document.createElementNS(t,"feComposite");l.setAttribute("operator","in");l.setAttribute("in","color");l.setAttribute("in2","inverse");l.setAttribute("result","shadow");e.appendChild(l);r=document.createElementNS(t,"feComposite");r.setAttribute("operator","over");r.setAttribute("in","shadow");r.setAttribute("in2","SourceGraphic");e.appendChild(r);if(!this.config.hideInnerShadow){this.canvas.canvas.childNodes[2].setAttribute("filter","url(#"+this.config.id+"-inner-shadow)");this.canvas.canvas.childNodes[3].setAttribute("filter","url(#"+this.config.id+"-inner-shadow)")}e,a,n,o,s,l,r=null};function getColor(t,i,e,a,n){var o,s,l,r,h,c,f,m,u,g,d,p,x,b;var a=a||n.length>0;if(n.length>0){for(var v=0;v<n.length;v++){if(t>n[v].lo&&t<=n[v].hi){return n[v].color}}}o=e.length;if(o===1)return e[0];s=a?1/o:1/(o-1);l=[];for(var v=0;v<e.length;v++){r=a?s*(v+1):s*v;h=parseInt(cutHex(e[v]).substring(0,2),16);c=parseInt(cutHex(e[v]).substring(2,4),16);f=parseInt(cutHex(e[v]).substring(4,6),16);l[v]={pct:r,color:{r:h,g:c,b:f}}}if(i===0){return"rgb("+[l[0].color.r,l[0].color.g,l[0].color.b].join(",")+")"}for(var y=0;y<l.length;y++){if(i<=l[y].pct){if(a){return"rgb("+[l[y].color.r,l[y].color.g,l[y].color.b].join(",")+")"}else{m=l[y-1];u=l[y];g=u.pct-m.pct;d=(i-m.pct)/g;p=1-d;x=d;b={r:Math.floor(m.color.r*p+u.color.r*x),g:Math.floor(m.color.g*p+u.color.g*x),b:Math.floor(m.color.b*p+u.color.b*x)};return"rgb("+[b.r,b.g,b.b].join(",")+")"}}}}function setDy(t,i,e){if(!ie||ie>9){t.node.firstChild.attributes.dy.value=0}}function getRandomInt(t,i){return Math.floor(Math.random()*(i-t+1))+t}function cutHex(t){return t.charAt(0)=="#"?t.substring(1,7):t}function humanFriendlyNumber(t,i){var e,a,n,o;e=Math.pow;a=e(10,i);n=7;while(n){o=e(10,n--*3);if(o<=t){t=Math.round(t*a/o)/a+"KMGTPE"[n]}}return t}function getStyle(t,i){var e="";if(document.defaultView&&document.defaultView.getComputedStyle){e=document.defaultView.getComputedStyle(t,"").getPropertyValue(i)}else if(t.currentStyle){i=i.replace(/\-(\w)/g,function(t,i){return i.toUpperCase()});e=t.currentStyle[i]}return e}function onCreateElementNsReady(t){if(document.createElementNS!==undefined){t()}else{setTimeout(function(){onCreateElementNsReady(t)},100)}}var ie=function(){var t,i=3,e=document.createElement("div"),a=e.getElementsByTagName("i");while(e.innerHTML="<!--[if gt IE "+ ++i+"]><i></i><![endif]-->",a[0]);return i>4?i:t}();